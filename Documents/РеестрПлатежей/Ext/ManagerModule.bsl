

Процедура Печать(ТабДок, Ссылка) Экспорт
	Макет = Документы.РеестрПлатежей.ПолучитьМакет("Печать");
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	РеестрПлатежей.Дата КАК Дата,
	|	РеестрПлатежей.Организация КАК Организация,
	|	РеестрПлатежей.Заявки.(
	|		НомерСтроки КАК НомерСтроки,
	|		Заявка КАК Заявка,
	|		Заявка.Контрагент КАК Контрагент,
	|		Заявка.НазначениеПлатежа КАК Назначение,
	|		Заявка.СтатьяДвиженияДенежныхСредств КАК Статья,
	|		Заявка.ДоговорКонтрагента КАК Договор,
	|		Заявка.СуммаДокумента КАК Сумма,
	|		Заявка.СчетКонтрагента.Банк.Наименование КАК банкПолучатель
	|	) КАК Заявки
	|ИЗ
	|	Документ.РеестрПлатежей КАК РеестрПлатежей
	|ГДЕ
	|	РеестрПлатежей.Ссылка В(&Ссылка)";
	Запрос.Параметры.Вставить("Ссылка", Ссылка);
	Выборка = Запрос.Выполнить().Выбрать();
	ВставлятьРазделительСтраниц = Ложь;
	Пока Выборка.Следующий() Цикл
		Если ВставлятьРазделительСтраниц Тогда
			ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;

	Организация =Выборка.Организация;
	Дата =Выборка.Дата; 
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	Руководители = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
	ОбластьЗаголовок.Параметры.Руководитель = Руководители.РуководительПредставление;
	ОбластьЗаголовок.Параметры.Дата = дата;
	ТабДок.Вывести(ОбластьЗаголовок);

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток КАК СуммаНачальныйОстаток,
		|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток КАК СуммаКонечныйОстаток,
		|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт КАК СуммаОборотДт
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет = ЗНАЧЕНИЕ(плансчетов.хозрасчетный.РасчетныеСчета), , Организация = &Организация) КАК ХозрасчетныйОстаткиИОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток КАК СуммаКонечныйОстаток
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет = ЗНАЧЕНИЕ(плансчетов.хозрасчетный.ДепозитныеСчета), , Организация = &Организация) КАК ХозрасчетныйОстаткиИОбороты";
	
	Запрос.УстановитьПараметр("КонецПериода", КонецДня(Дата));
	Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(Дата));
	Запрос.УстановитьПараметр("Организация", Организация);
	
	РезультатЗапроса = Запрос.ВыполнитьПакет();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса[0].Выбрать();
	ВыборкаДетальныеЗаписиДепозит = РезультатЗапроса[1].Выбрать();
	Шапка = Макет.ПолучитьОбласть("Шапка");
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда 
		Шапка.Параметры.Остаток = ВыборкаДетальныеЗаписи.СуммаНачальныйОстаток;
		Шапка.Параметры.Поступления = ВыборкаДетальныеЗаписи.СуммаОборотДт;
		Шапка.Параметры.Свободные = ВыборкаДетальныеЗаписи.СуммаКонечныйОстаток;

	КонецЕсли;;
	Если ВыборкаДетальныеЗаписиДепозит.Следующий() Тогда 
		Шапка.Параметры.Депозиты = ВыборкаДетальныеЗаписиДепозит.СуммаКонечныйОстаток;

	КонецЕсли;;
	
	ТабДок.Вывести(Шапка);

	
	
	ОбластьЗаявкиШапка = Макет.ПолучитьОбласть("ЗаявкиШапка");
	ТабДок.Вывести(ОбластьЗаявкиШапка);
	
	ОбластьЗаявки = Макет.ПолучитьОбласть("Заявки");
	ВыборкаЗаявки = Выборка.Заявки.Выбрать();
	Итого = 0;
	Пока ВыборкаЗаявки.Следующий() Цикл
		Итого = Итого +ВыборкаЗаявки.Сумма ;
		ОбластьЗаявки.Параметры.Заполнить(ВыборкаЗаявки);
		ОбластьЗаявки.Параметры.Договор=ВыборкаЗаявки.Договор.Номер+" от "+Формат(ВыборкаЗаявки.Договор.Дата,"ДФ=dd.MM.yyyy");
		ТабДок.Вывести(ОбластьЗаявки);
	КонецЦикла;

	ОбластьИтог = Макет.ПолучитьОбласть("Итог");
	ОбластьИтог.Параметры.Сумма = Итого;
	ТабДок.Вывести(ОбластьИтог);
	ОбластьПодписи = Макет.ПолучитьОбласть("Подписи");
	ТабДок.Вывести(ОбластьПодписи);

		ВставлятьРазделительСтраниц = Истина;
КонецЦикла;	
КонецПроцедуры
